{% extends "master.html" %}

{% block title %}Bands - Home{% endblock %}

{% block content %}

    <section id="funcionalidades-home" class="funcionalidades-home">
        <a href="{{ url_for('login') }}">
            <article id="cadastre-bandas" class="cadastre-bandas">
                <span class="cadastre-bandas-icone"></span>
                <h2>Cadastre Bandas</h2>
            </article>
        </a>

        <a href="{{ url_for('login') }}">
            <article id="siga-bandas" class="siga-bandas ">
                <span class="siga-bandas-icone"></span>
                <h2>Siga Bandas</h2>
            </article>
        </a>

        <article id="acompanhe-shows" class="acompanhe-shows">
            <span class="acompanhe-shows-icone"></span>
            <h2>Acompanhe os Shows</h2>
        </article>
    </section>

    <section id="area-show-home" class="area-show-home">

        <article id="shows-local" class="shows-local">
            <h2>Shows Locais</h2>
            {% if not newsletter_locais %}
                <div class="newsletter newsletter-shows-locais">
                    <span class="question">Gostaria de receber novos shows locais por email?</span>
                    <a class="answer shiny-red" href="#" onClick="_gaq.push(['_trackEvent', 'Newsletter', 'Show local', 'Show local: sim']);">Sim</a>
                    <a class="answer shiny-red" href="#" onClick="_gaq.push(['_trackEvent', 'Newsletter', 'Show local', 'Show local: nao']);">Não</a>
                </div>
            {% endif %}
            <ul>
                {% for show in shows_locais %}
                    {%- set band_name = show.artists[0].name -%}
                    {%- set website = show.website -%}
                    {% if not website %}
                        {%- set website = show.location.website -%}
                    {% endif %}
                    <li>
                        <a href="{{ website }}" target="_blank" class="item-lista-shows" onClick="_gaq.push(['_trackEvent', 'Show', 'Ver show local', 'Banda: {{ band_name }} Show: {{ show.title }}']);">
                            {% if show.cover_image %}
                                <img src="{{ show.cover_image }}" />
                            {% else %}
                                {% if show.location.image %}
                                    <img src="{{ show.cover_image }}" />
                                {% else %}
                                    <span class="icone-musicas img-default"></span>
                                {% endif %}
                            {% endif %}
                            <span class="info-show">
                                <span class="banda-show">{{ band_name }}</span>
                                <span class="data-show">{{ show.title }} - {{ show.datetime }}</span>
                            </span>
                        </a>
                    </li>
                {% endfor %}
            </ul>

        </article>

        <article id="minhas-bandas-shows" class="minhas-bandas-shows">
            <h2>Shows das minhas bandas</h2>

            {% if current_user %}
            {% if not newsletter_meus_shows %}
                <div class="newsletter newsletter-meus-shows">
                    <span class="question">Gostaria de receber os shows da sua banda por email?</span>
                    <a class="answer shiny-red" href="#" onClick="_gaq.push(['_trackEvent', 'Newsletter', 'Meu show', 'Meu show: sim']);">Sim</a>
                    <a class="answer shiny-red" href="#" onClick="_gaq.push(['_trackEvent', 'Newsletter', 'Meu show', 'Meu show: nao']);">Não</a>
                </div>
            {% endif %}
            <ul>
                {% if minhas_bandas_shows %}
                    {% for band, band_shows in minhas_bandas_shows %}
                        {%- set show = band_shows[0] -%}
                        {%- set website = show.website -%}
                        {% if not website %}
                            {%- set website = show.location.website -%}
                        {% endif %}
                        <li>
                            <a href="{{ website }}" {% if website %} target="_blank" {% endif %} class="item-lista-shows" onClick="_gaq.push(['_trackEvent', 'Show', 'Ver show local', 'Banda: {{ band.name }} Show: {{ show.title }}']);">
                                {% if show.cover_image %}
                                    <img src="{{ show.cover_image }}" />
                                {% else %}
                                    {% if show.location.image %}
                                        <img src="{{ show.cover_image }}" />
                                    {% else %}
                                        <span class="icone-musicas img-default"></span>
                                    {% endif %}
                                {% endif %}
                                <span class="info-show">
                                    <span class="banda-show">{{ band.name }}</span>
                                    <span class="data-show">{{ show.title }} - {{ show.datetime }}</span>
                                </span>
                            </a>
                        </li>
                    {% endfor %}
                {% else %}
                    <span class="explicacao">
                        <p>Nenhum show está cadastro no momento para as bandas que você gosta.</p>
                        <p><a href="">Tente novamente em 5 minutos, enquanto buscamos...</a></p>
                    </span>
                {% endif %}
            </ul>
            {% else %}
                <article class="cadastro">
                    <span class="explicacao">Para ver os shows das suas bandas:</span>
                    <a href="/login/" onClick="_gaq.push(['_trackEvent', 'Login', 'Login Botao', 'Botao Faca Login', 'Login area minhas bandas pela index page']);" class="btn-auth btn-facebook large login-facebook">
                        Faça login pelo
                        <b>Facebook</b>
                    </a>
                </article>
            {% endif %}
        </article>

    </section>

{% endblock %}
