{% import 'band_question.html' as band_question %}
{% import 'band_tags.html' as band_tags %}
{% import 'bandas_relacionadas.html' as bandas_relacionadas %}
{% import 'band_history.html' as band_history %}

{% macro escreve_banda(band, show, notas) -%}
    <li id="{{ band.slug }}" class="banda-container-li round-component box-gray">
        <div id="area-banda" class="area-banda">
            {% if band.photo %}
                <img class="lastfm-photo logo-banda" alt="imagem da banda" src="{{ band.photo }}" />
            {% else %}
                <span title="imagem da banda" class="lastfm-photo logo-banda icone-banda-default"></span>
            {% endif %}
            <div class="logo-banda-container" title="imagem da banda"></div>
        </div>

        <div class="info-banda">
            <h2 class="info-banda-header">
                <span class="info-banda-nome">{{ band.name }}</span>
                <span class="info-banda-header-menor">Nota:
                    <select class="nota">
                        {% for nota in notas %}
                            <option value="{{ nota }}" {% if nota == 7 %}selected="selected"{% endif %}>{{ nota }}</option>
                        {% endfor %}
                    </select>
                </span>
                <span class="info-banda-header-menor">Favoritar: <a href="#{{ band.slug }}" class="favoritar"></a></span>
            </h2>
            <div class="info-banda-genero-div">
                <a class="info-banda-genero info-banda-link" data-toggle="modal" data-target="#modal-tags-{{ band.slug }}" href="#{{ band.slug }}">{{ band.tags[0] }}</a>
            </div>
            <div class="banda-mais-opcoes">
                <button type="button" class="shiny-red" data-toggle="modal" data-target="#modal-history-{{ band.slug }}" onClick="_gaq.push(['_trackEvent', 'Band', 'Ver Historia em uma pesquisa de banda', 'Banda: {{ band.name }}']);">História da Banda numa timeline</button>
                <button type="button" class="shiny-red" data-toggle="modal" data-target="#modal-pergunte-{{ band.slug }}" onClick="_gaq.push(['_trackEvent', 'Band', 'Pergunte sobre a banda em uma pesquisa de banda', 'Banda: {{ band.name }}']);">Faça uma pergunta sobre a banda</button>
            </div>
            {% if show %}
                <h3>Shows</h3>
                {%- set website = show.website -%}
                {% if not website %}
                    {%- set website = show.location.website -%}
                {% endif %}
                <div class="navegacao-show-container">
                    <button type="button" title="show anterior" class="band-navegacao-show band-prev-show" data-toggle="modal" data-target="#modal-mais-shows" onClick="_gaq.push(['_trackEvent', 'Show', 'Mais shows Esq em uma pesquisa de banda', 'Banda: {{ band.name }}']);"></button>
                    <a {% if website %} href="{{ website }}" target="_blank" {% else %} href="#" {% endif %} class="item-lista-shows item-lista-bands" onClick="_gaq.push(['_trackEvent', 'Show', 'Show em uma pesquisa de banda', 'Banda: {{ band.name }} Show: {{ show.title }}']);">
                        {% if show.cover_image %}
                            <img alt="imagem do show" title="imagem do show" src="{{ show.cover_image }}" />
                        {% else %}
                            {% if show.location.image %}
                                <img alt="imagem do show" title="imagem do show" src="{{ show.location.image }}" />
                            {% else %}
                                <span title="imagem do show" class="icone-musicas img-default"></span>
                            {% endif %}
                        {% endif %}
                        <span class="info-show item-info">
                            <span class="banda-show">{{ show.datetime }}</span>
                            <span class="data-show">{{ show.title }}</span>
                        </span>
                    </a>
                    <button type="button" title="próximo show" class="band-navegacao-show band-next-show" data-toggle="modal" data-target="#modal-mais-shows" onClick="_gaq.push(['_trackEvent', 'Show', 'Mais shows Dir em uma pesquisa de banda', 'Banda: {{ band.name }}']);"></button>
                </div>
            {% endif %}
            <div class="banda-mais-opcoes">
                <button type="button" class="shiny-red" data-toggle="modal" data-target="#modal-relacionadas-{{ band.slug }}" onClick="_gaq.push(['_trackEvent', 'Band', 'Bandas relacionadas em uma pesquisa de banda', 'Banda: {{ band.name }}']);">Bandas relacionadas</button>
                <button type="button" class="shiny-red comprar-ingressos-camisas" data-toggle="modal" data-target="#modal-produtos" onClick="_gaq.push(['_trackEvent', 'Produtos', 'Ingressos e produtos em uma pesquisa de banda', 'Banda: {{ band.name }}']);">Comprar ingressos e camisas</button>
            </div>
        </div>

        {{ band_question.gera_modal(band.slug) }}
        {{ band_tags.gera_modal(band) }}
        {{ bandas_relacionadas.gera_modal(band) }}
        {{ band_history.gera_modal(band) }}

        <button type="button" class="close-banda" onClick="_gaq.push(['_trackEvent', 'Band', 'Fechar o box da banda', 'Banda: {{ band.name }}']);">&times;</button>
    </li>
{%- endmacro %}
